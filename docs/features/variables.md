# 変数
変数とは、値に名前付けをするものです。
特に最近のプログラムでは、意味のない名前（x,y,zなど）ではなく、意味のある名前（userNameなど）を基本的に付けます。

## 基本的な使い方

### 変数の設定・削除
```
# 変数の代入
setvar 変数名 値                      # 関数内変数
setvarG 変数名 値                     # グローバル変数

# 変数のコピー（配下の要素をすべてコピーする）
copyvar コピー元変数名 コピー先変数名     # 関数内変数
copyvarG コピー元変数名 コピー先変数名    # グローバル変数

# 変数の削除
delvar 変数名                        # 関数内変数を削除
delvarG 変数名                       # グローバル変数を削除
```

### 変数の埋め込み
```
<変数名>             # 通常の変数埋め込み
<変数名!>            # エスケープ（変数として処理せず、そのまま<変数名>として表示）
```

## 組み込み変数
システムが提供する特殊な変数です。詳細は定義済み変数のドキュメントを参照してください。

## 変数の存在チェック
```
<変数名?>　　　　　　　# 変数が存在するかのチェック（階層チェック）
<変数名??>          # 変数が直接存在するかチェック（直接チェック）
```

結果は `true` または `false` を返します。
## 変数のスコープ

### 関数内変数
- `setvar` で設定される変数
- その関数内でのみ有効
- 関数終了時に自動的に削除される

### グローバル変数
- `setvarG` で設定される変数
- すべての関数からアクセス可能
- 明示的に削除するまで残存する

### 変数の優先順位
同じ名前の変数が存在する場合：
1. 関数内変数が優先される
2. 関数内に存在しない場合、グローバル変数が参照される

## データ型と型変換

### サポートされるデータ型
- **文字列**: 任意のテキスト
- **数値**: 整数・小数点数（内部的にはdouble型として処理）

### 型変換の動作
- 演算時に自動的に数値変換を試行
- 変換できない場合はエラーを出す
- 小数点以下が0の場合、自動的に整数表記になる（例：`5.0` → `5`）

## エラーハンドリング

### 存在しない変数
- 存在しない変数を参照した場合、そのまま `<変数名>` として残る
- 演算で存在しない変数を使用した場合、その演算はスキップされる

### 演算エラー
- ゼロ除算: 結果は `0` を返す
- 数値変換エラー: エラーを出す

## 実用的な使用例

### 基本的な変数操作
```
# 関数内変数bakaにahoを代入
setvar baka aho
# bakaのコピーkasuを作成
copyvar baka kasu
# 表示
cmd say <baka>
# これでahoと表示されます。
cmd say <baka!>
# こうすると、変数としてではなく、ただの<baka>として実行されます。

# グローバル変数(どこからもアクセス可)zaemonにdaisukiを代入
setvarG zaemon daisuki
# 関数内変数bakaを削除
delvar baka
# グローバル変数zaemonを削除
delvarG zaemon
```

### 組み込み変数の使用
```
# システム提供の変数を使用
setvar currentTime <unixtime>
cmd say 現在時刻: <currentTime>
```

※ 利用可能な組み込み変数については定義済み変数のドキュメントを参照してください。

### 変数存在チェック
```
# 変数が直接存在するかチェック
cmd say 変数直接存在: <score??>
```

### 数値演算の例
```
# 変数を使った計算
setvar a 10
setvar b 3
cmd say 計算結果: <a+b>     # 結果: 13
```

※ 四則演算の詳細については別ドキュメントを参照してください。

### 比較演算の例
```
setvar score1 85
setvar score2 92

cmd say スコア比較結果: <score1<score2>    # 結果: true
```

※ 比較演算の詳細については別ドキュメントを参照してください。

### 条件分岐での活用
```
# 変数存在による分岐
cmd say 初回起動: <firstTime??>
```

※ その他の条件分岐については別ドキュメントを参照してください。

### 複雑な演算の組み合わせ
```
setvar x 5
setvar y 3
setvar z 2

# 複数の演算を組み合わせ（内側から処理される）
setvar result1 <x+y>
setvar finalResult <result1*z>
cmd say 結果: <finalResult>    # (5+3)*2 = 16
```

※ 基本的な演算については別ドキュメントを参照してください。

### エラーケースの対処
```
# 存在しない変数への対処
cmd say 値: <nonExistentVar>   # そのまま<nonExistentVar>と表示

# 数値変換エラー
setvar text "hello"
setvar num 5
cmd say 計算結果: <text+num>   # エラーが発生

# ゼロ除算
setvar zero 0
cmd say 除算結果: <num/zero>   # 結果: 0
```

## 注意事項
- 変数名は英数字とピリオド（.）のみ使用可能
- 演算は左から右に順次処理される
- 複雑な演算は中間変数を使用することを推奨
- グローバル変数の使いすぎはメモリ使用量増加の原因となるため注意